package com.pizza73.util;

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.orm.hibernate3.SessionHolder;
import org.springframework.transaction.support.TransactionSynchronizationManager;

import com.pizza73.service.LookupManager;
import com.pizza73.service.StoreHoursManager;

/**
 * StreetAddressMappingTest.java TODO comment me
 * 
 * @author chris 9-Mar-07
 * 
 * @Copyright Flying Pizza 73
 */
public class StoreOpenTest {
	protected ClassPathXmlApplicationContext ctx;
	private SessionFactory sf = null;
	private LookupManager mgr;
	private StoreHoursManager hoursMgr;

	public void setLookupManager(LookupManager mgr) {
		this.mgr = mgr;
	}

	public void setStoreHoursManager(StoreHoursManager hours) {
		this.hoursMgr = hours;
	}

	public void setUp() {
		String[] paths = { "util-applicationContext-resources.xml",
				"applicationContext.xml" };
		ctx = new ClassPathXmlApplicationContext(paths);
		sf = (SessionFactory) ctx.getBean("sessionFactory");
		Session s = sf.openSession();
		TransactionSynchronizationManager
				.bindResource(sf, new SessionHolder(s));
		mgr = (LookupManager) ctx.getBean("lookupManager");
		hoursMgr = (StoreHoursManager) ctx.getBean("storeHoursManager");
	}

	public static void main(String[] args) throws Exception {
		StoreOpenTest storeOpen = new StoreOpenTest();
		storeOpen.setUp();
		
		System.out.println("Store is open for NULL city: " + storeOpen.hoursMgr.isStoreOpen(null));
		System.out.println("Store is open for Edmonton city: " + storeOpen.hoursMgr.isStoreOpen(1));
		System.out.println("Store is open for Calgary city: " + storeOpen.hoursMgr.isStoreOpen(2));
		
		
	}
}
